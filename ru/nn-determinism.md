# Принципиальная детерминированность нейросетей

По роду деятельности сталкиваюсь с утверждением, о принципиальной 
недетерминированносте результатов работы нейросетей при одинаковых входных 
данных.

УТВЕРЖДАЮ: для любой математической нейросети `r=f( [a], [w] )` любого типа 
(LLM, сверточная, рекуррентная, трансформер и др.), при фиксированных аргументах 
`[a]`, фиксированных весах `[w]` и идентичных условиях исполнения, результат `r` 
детерминирован; любая вариация результата без изменения `[a]`, `[w]` или условий 
исполнения является ошибкой реализации.

Разберём возможные возражения — факторы, которые часто называют причиной 
недетерминированности, но на деле ею не являются.



## Недетерминированность входных данных

*Возражение*: сеть принципиально недетерминирована из-за случайных компонентов или 
инициализации.

*Опровержение*: все численные значения, включая веса, фиксированы; внутренней 
случайности без изменения аргументов нет. Любое нарушение условия идентичных 
аргументов для последовательных вычислений является ошибкой реализации.



## Аппаратная недетерминированность

*Возражение*: результат может меняться из-за аппаратной недетерминированности.

*Опровержение*: при фиксированном железе, точности и порядке операций аппаратная 
недетерминированность исключена, наличие детерминированности говорит об 
аппаратных ошибках и недостоверном результате.



## Софтовая недетерминированность

*Возражение*: результат может меняться из-за реализации в программном 
обеспечении включая версии библиотек, внутреннее кеширование или оптимизации.

*Опровержение*: это нарушение условий «прочих равных». При идентичном окружении, 
версиях библиотек и порядке операций результат либо гарантированно 
детерминирован либо его следует классифицировать как ошибки программного 
обеспечения.



## Алгоритмическая недетерминированность

*Возражение*: результат может меняться из-за алгоритмической 
недетерминированности, включая параллельное исполнение, гонки и порядок 
операций.

*Опровержение*: недетерминированность без изменения входов = баг. Алгоритм 
обязан давать один результат при фиксированных данных и фиксированном порядке 
шагов; если порядок «плавает» провоцируя для `x+y+z` результат 
`(x+y)+z≠x+(y+z)`, это некорректная реализация.



## Внешние факторы

*Возражение*: сеть может давать разные результаты из-за нечётких операций
и параметров внешнего мира.

*Опровержение*: любой параметр внешнего мира, включая квантовые операции и 
другие внешние факторы, может быть отражён только через аргументы модели. Если 
фактор напрямую влияет на результат без явного включения в аргументы, это ошибка 
реализации.



# Действия

Разберём, какие действия следует предпринять при обнаружении 
недетерминированности в модели.



## Признание проблемы

Наличие недетерминированности является индикатором проблемы; принципиальной, 
неустранимой недетерминированности в корректной математической модели не бывает.



## Анализ проблемы

При обнаружении недетерминированности источник проблемы необходимо определить и 
классифицировать по одной из категорий, рассмотренных выше:
1. Аргументы — случайность во входах или весах, незарегистрированные изменения 
   состояний и прочее; если все аргументы включая веса идентичны, это не 
   причина.
2. Аппаратная недетерминированность — отличается порядок операций, ошибки 
   железа; при идентичном железе недетерминированность исключается.
3. Софтовая недетерминированность — версия библиотек, оптимизации; при 
   идентичном окружении недетерминированность исключается.
4. Алгоритмическая недетерминированность — ошибки реализации, параллелизм, 
   нарушение последовательности операций; недопустимо для математических 
   моделей. 



## Реализация недетерминируемости

Допускаю случаи необходимости "случайности". Однако она должна быть явно 
включена в аргументы модели, с документированным объяснением цели и источника, а 
так же с возможностью ее последовательного испытания на идентичных аргументах. 
При этом модель обязана по прежнему демонстрировать детерминируемость.



# Выводы

На основе изложенного формирую следующие выводы:
1. считаю, утверждение о **принципиальной** недетерминированности математической 
нейросети свидетельствует об отсутствии информации о происходящем либо о 
сокрытии ошибок на аппаратном, программном или алгоритмическом уровнях.
2. Невозможность демонстрации нейросетью детерминированных результатов следует 
считать проблемой, требующей решения, особенно при применении в 
business-critical и mission-critical системах.
3. применение любых моделей для mission-critical и business-critical систем 
должно основываться на понимании источников недетерминированности её описания и 
контроля.
