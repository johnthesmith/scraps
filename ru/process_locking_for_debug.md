# Блокировка потока при интерактивной отладке

1. [Задача](#задача)
0. [Решение](#решение)
    1. [Аргументы](#аргументы)
    0. [Результат](#результат)
    0. [Псевдокод](#псевдокод)
0. [Дополнительно](#дополнительно)
0. [Резюме](#резюме)


# Задача

1. В многопоточном приложении с существенной нагрузкой при отладке и эксплуатации необходима интерактивная приостановка потока для разбора ситуации.
0. Решение должно минимизировать средства.



# Решение

1. В приложении реализуется метод lock, выполняющий блокировку исполняемого потока до действия пользователя.
0. Блокировка осуществляется созданием файла и последующим ожиданием его удаления.
0. Файл содержит отладочную информацию, формируемую разработчиком.



## Аргументы

1. file - имя файла блокировки;
0. content - содержимое файла блокировки, определяемое разработчиком.



## Результат

1. Строковый код состояния успешности блокировки.



## Псевдокод

```
bool lock
(
    string file,
    string content
)
{
    string result;

    if( checkPath( getPath( file )))
    {
        /* Создание файла */
        if( createFile( file, content ))
        {
            /* Ожидание удаления файла */
            while( fileExists( file ) )
            {
                sleepMls( 100 );
            }
            result = "ok";
        }
        else
        {
            result = "file_create_error";
        }
    }
    else
    {
        result = "path_create_error";
    }   

    return result;
}
```


# Дополнительно

1. Метод может быть расширен ограничением времени ожидаения удаления файла с выходом из цикла и последующим автоматическим удалением файла.
0. Вызов метода может осуществлятся на основе конфигурационного параметра каждого конкретного потока.


# Резюме

1. Метод прост в реализации и использовании.
0. Не требует необходимости UI на уровне отладки и эксплуатации.
0. Применим в многопоточных приложениях.

